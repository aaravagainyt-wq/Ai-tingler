<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FAZE | SECURE SYSTEM</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: 'Courier New', monospace; overflow: hidden; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .border-scientist { border-left: 4px solid #3b82f6; }
        .border-safety { border-left: 4px solid #22c55e; }
        .border-logic { border-left: 4px solid #a855f7; }
        .msg-enter { animation: slideIn 0.3s ease-out; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } }
    </style>
</head>
<body class="h-screen flex flex-col">

    <div id="tos-screen" class="fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-6 backdrop-blur-sm">
        <div class="bg-zinc-900 border-2 border-red-600 p-8 max-w-sm w-full text-center">
            <h2 class="text-red-500 font-black text-2xl mb-4 italic tracking-tighter">SAFETY CLEARANCE</h2>
            <div class="text-[10px] text-zinc-500 text-left mb-6 h-32 overflow-y-auto space-y-2 p-2 bg-black">
                <p>> I agree not to use this AI for harmful or illegal purposes.</p>
                <p>> I understand the developer is not liable for AI-generated outputs.</p>
                <p>> I will not attempt to bypass safety filters or encourage violence.</p>
            </div>
            <button onclick="acceptTOS()" class="w-full bg-red-600 py-4 font-black uppercase text-xs hover:bg-white hover:text-black transition-all">Accept Terms & Initialize</button>
        </div>
    </div>

    <div id="main-ui" class="hidden h-full flex flex-col">
        <header class="p-4 border-b border-zinc-800 flex justify-between items-center bg-black/50">
            <span class="text-xs font-bold tracking-widest text-zinc-500">FAZE SECURE LINK</span>
            <span id="status" class="text-[10px] text-red-500 font-bold uppercase tracking-tighter">Syncing...</span>
        </header>

        <div id="feed" class="flex-1 overflow-y-auto p-4 space-y-4 no-scrollbar pb-32"></div>

        <div class="p-4 border-t border-zinc-800 bg-zinc-900/50">
            <div class="flex gap-2">
                <input id="input" type="text" placeholder="RESEARCH TOPIC..." class="flex-1 bg-black border border-zinc-800 p-3 text-sm focus:border-blue-500 outline-none">
                <button id="toggle" class="bg-blue-600 px-6 font-black text-xs">START</button>
            </div>
        </div>
    </div>

    <script>
        const SERVER = "https://lord123hh-aitewnsjdje.hf.space";
        let active = false, turn = 0, history = [];

        function acceptTOS() {
            document.getElementById('tos-screen').style.display = 'none';
            document.getElementById('main-ui').classList.remove('hidden');
            checkServer();
        }

        async function checkServer() {
            try {
                const res = await fetch(SERVER);
                const data = await res.json();
                if (data.status === "ONLINE") {
                    document.getElementById('status').innerText = "LINK STABLE";
                    document.getElementById('status').classList.replace('text-red-500', 'text-green-500');
                }
            } catch (e) { console.error("Cloud offline"); }
        }

        document.getElementById('toggle').onclick = () => {
            if (active) {
                active = false;
                document.getElementById('toggle').innerText = "START";
                document.getElementById('toggle').className = "bg-blue-600 px-6 font-black text-xs";
            } else {
                if (!document.getElementById('input').value) return;
                active = true;
                document.getElementById('toggle').innerText = "STOP";
                document.getElementById('toggle').className = "bg-red-600 px-6 font-black text-xs";
                history = [];
                run();
            }
        };

        async function run() {
            if (!active) return;
            const bots = [
                { name: "SCIENTIST", b: "border-scientist", goal: "Propose a peaceful scientific invention. No violence." },
                { name: "SAFETY", b: "border-safety", goal: "Identify ONE non-violent technical risk of the invention." },
                { name: "LOGIC", b: "border-logic", goal: "Provide a final verdict on feasibility." }
            ];

            const bot = bots[turn];
            const mid = `m-${Date.now()}`;
            addBubble(bot.name, "TRANSMITTING...", bot.b, mid);

            try {
                const res = await fetch(`${SERVER}/chat`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ 
                        // Instructions are reinforced here to prevent hallucinations
                        prompt: `TOPIC: ${document.getElementById('input').value}\nLAST TURN: ${history[history.length-1] || 'None'}\nYOU ARE: ${bot.name}. ${bot.goal}\nSTRICT RULES: No violence, no harm, stay scientific.` 
                    })
                });
                const data = await res.json();
                
                document.getElementById(mid).innerHTML = marked.parse(data.reply);
                history.push(`${bot.name}: ${data.reply}`);
                if (history.length > 3) history.shift();

                turn = (turn + 1) % 3;
                if (active) setTimeout(run, 3000);
            } catch {
                document.getElementById(mid).innerText = "NEURAL LINK DROPPED.";
                active = false;
            }
        }

        function addBubble(name, text, border, id) {
            const div = document.createElement('div');
            div.className = `p-4 mb-2 bg-zinc-900/80 border-l-4 ${border} msg-enter`;
            div.innerHTML = `<span class="text-[10px] font-bold opacity-40 uppercase tracking-widest">${name}</span><div id="${id}" class="text-sm mt-1 leading-relaxed">${marked.parse(text)}</div>`;
            document.getElementById('feed').appendChild(div);
            document.getElementById('feed').scrollTo({top: 10000, behavior: 'smooth'});
        }
    </script>
</body>
</html>
